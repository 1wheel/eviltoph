(function() {
  // some tools for generating response
  var natural = require('natural');
  var markov = require('markov');
  var m = markov(1);

  var Slack, autoMark, autoReconnect, slack, token;
  Slack = require('slack-client');
  token = 'PUT_TOKEN_HERE';
  autoReconnect = true;
  autoMark = true;
  slack = new Slack(token, autoReconnect, autoMark);

  // some toph tweets
  var toph = ['Why do people burst out into speech? Some electrostatic potential differential breaches athreshold, seeks agreement... pic.twitter.com/049JPwd7f2  ','wow life is so long  ','"I find cash illiquid relative to Venmo." —@theidesofdward  ','"Secure golden key": old fantasy of a tool wieldable only by worthy, that embeds the morality of whoever forged it. Has there ever been one?  ','Baudrillard on the "fun morality" pic.twitter.com/Ah3tSkYrgY  ','https://dl.dropboxusercontent.com/u/50282823/Propagation.pdf...  ','@tophtucker because it never learns  ','@tophtucker add stupidity and it gets antifragile  ','Ignorance is fragile bliss.  ','Part-time solo experimental UI designer, part-time web designer at @kiskolabs. Dabbling in game design.','As much as I love this photo https://twitter.com/manhattan_js/status/619000084735356928..., basically all good code stuff you see on the page was @adamrpearce.','Sometimes I am so awed by remembering a perfectly banal memory that I feel like I must only just be discovering the act of remembering.  ','@tophtucker somewhat like this maybe? pic.twitter.com/uMF74RRHlF  ','That time when @ftrain gave @tophtucker @stephcd $1,000,000,000 for bringing his #whatiscode to life.pic.twitter.com/fD3QwqTWJF','1963 @thecrimson review of Lawrence of Arabia, brilliant from lede to kicker http://www.thecrimson.com/article/1963/1/9/lawrence-of-arabia-pilawrence-of-arabiai/...  ','What flower blossoms faster in a summer afternoon downpour than an ad hoc umbrella salesman, and what market niche does it fill?','finally joined The WELL  ','"from the vantage point of the historian...there’s never enough time to do something right, but there’s always enough time to do it over."  ','"How Do Committees Invent?" by Melvin E. Conway http://www.melconway.com/Home/Committees_Paper.html... pic.twitter.com/bcsqPgdKYf  ','There is a surprising amount of interesting stuff that\'s not on the Internet  ','Publishing something terrible, exactly as drafted last July 4: "Transformers 4 and the fungibility of all things" https://medium.com/@tophtucker/transformers-4-and-the-fungibility-of-all-things-aa2433b4065f?source=tw-a9a4fc283e2-1435949859724...  ','Conjecture: A lot of people who think they dislike modernity really just miss being young.  ','#simjourno http://www.nytimes.com/interactive/2015/07/03/upshot/a-quick-puzzle-to-test-your-problem-solving.html...  ','Neither very smooth nor very rough terrain creates pedestrian puddle problems; it\'s the mesoscale roughness that does pic.twitter.com/DxgHCWbVvO  ','The only thing better than sparkling water is tap water  ','Semi-bilingual signage suggests Japanese users of MSP will take taxi, bus, or hotel shuttle, not park or rent car pic.twitter.com/FjljDNhdxD  ','A thesaurus is useful because listed "synonyms" do *not* mean exactly the same thing. It more maps proximate, adjacent, ortho semantics.  ','What kinds of data other than geographical are topologically spherical? http://datascience.stackexchange.com/questions/6181/what-kinds-of-data-other-than-geographical-are-topologically-spherical...  ','What are the shearing layers of a book? Themes, TOC, text, figures, marginalia...? Related: skim/dive reading modes pic.twitter.com/xBq9EZXZS6  ','"The patrons shuffle out of Essentia Night studying their shoes, save a silent pair locked in tearful eye contact...2 remain unaccounted for..."  ','fun is pic.twitter.com/THozNQ5mJE  ','"Center of a black hole is a time" http://physics.stackexchange.com/q/190451?atw=1 #generalrelativity  ','data visualization by day, sleeping by night. latest: On Broadway http://on-broadway.nyc, visits http://v.isits.in  ','Interactive graphics and stories at The New York Times.  ','New York Magazine Approval Matrix phase space  ','The only lucid and appealing startup video I can recall https://www.youtube.com/watch?t=93v=ykGXIQAHLnA...  ','Are habitually faster drivers more likely to be found at the front or the back of a pack of cars?  ','Does refracting light believe it lives in the best of all possible worlds?  ','Anthropocene Park  ','How does it feel to be the 2x in x² + 2x as x→∞  ','Standing compression wave at the medial interface pic.twitter.com/XtPx7Zeq4C  ','Did critics sneer at the sequilitis embodied by yet another David in 1504, or the extravagant unoriginality of the Church’s ceiling in 1512?  ','What’s the relationship between symmetry and leverage?  ','tfw your article on code is also a top trending repository on GitHub https://github.com/trending h/t @ftrain @tophtucker pic.twitter.com/af2WELAs0h  ','i have been telling so many people "for sure yes let\'s / i\'ll do that, but after june 11"  ','nap  ','http://www.bloomberg.com/graphics/2015-paul-ford-what-is-code/...  ','I want to see percentage of people marrying their first loves over time. Changes the tenor of a generation! https://twitter.com/businessinsider/status/608149042460246016... ','Seems odd to say "People are bad at driving." Compared to what? May reflect negative skewness of aptitude distribution,mean near upper bound  ','Biochemically, a salmon swimming upstream is on the path of least resistance. Life arranges constraints to fix goals at a stationary point.  ','How long until China\'s first extrajudicial international drone assassination? Will it be the new Nuclear Club?  ','http://www.letsconsider.us/  ','On the other hand, beds love Procrustes.  ','Whoo boy, Decelerationism manifesto: http://www.philpercs.com/2015/06/decelerate-manifesto-for-a-decelerationist-anti-politics.html#more...  ','Mirror neurons do empathetic bare-metal emulation of others... https://en.wikipedia.org/wiki/Mirror_neuron... https://en.wikipedia.org/wiki/Hypervisor  ','This remains a fantastic positive testament to @voxdotcom’s trustworthiness. They’re not sloppy—just unusually candid http://theconcourse.deadspin.com/46-times-vox-totally-fucked-up-a-story-1673835447...  ','I like the subtle moments when people putting on an act for one another break the fourth wall.  ','childhood friend','"You can never step in the same river twice" assumes acyclicity. http://math.hws.edu/TMCM/java/labs/xLogicCircuitsLab2.html...  ','Finally starting to write about what I\'ve been working on: https://medium.com/@joehewitt/art-and-code-part-1-2f785dd007fd...  ','Tepid tutors often advise active voice, but never so forcefully: http://www.gutenberg.org/files/25308/25308-h/25308-h.htm... pic.twitter.com/bvEdTw16Fe'];
  // quotes from darth vader, voldemort, freddy krueger
  var evil = ['Where are those transmissions you intercepted? WHAT have you DONE with those plans? ','That name no longer has any meaning for me! ','The Rebels are alerted to our presence. Admiral Ozzel came out of lightspeed too close to the system. ','You are beaten. It is useless to resist. Don\'t let yourself be destroyed as Obi-Wan did. ','Alert my Star Destroyer to prepare for my arrival. ','Asteroids do not concern me, Admiral! I want that ship, not excuses! ','If this is a consular ship, WHERE is the ambassador? ','I have you now! ','A small rebel force has penetrated the shield and landed on Endor. ','A tremor in the Force. The last time I felt it was in the presence of my old master. ','Alert all commands. Calculate every possible destination along their last known trajectory. ','All too easy. ','And now, your highness, we will discuss the location of your hidden rebel base... ','Apology accepted, Captain Needa. ','As you wish. ','As you wish. ','As you wish. ','Bring my shuttle. ','Calrissian. Take the princess and the Wookie to my ship. ','Commander, tear this ship apart until you find those plans! And bring me all passengers, I want them ALIVE! ','Do they have a code clearance? ','Don\'t act so surprised, Your Highness. You weren\'t on any mercy mission this time. Several transmissions were beamed to this ship by rebel spies. I want to know what happened to the plans they sent you. ','Don\'t be too proud of this technological terror you\'ve constructed. The ability to destroy a planet is insignificant next to the power of the Force. ','Don\'t fail me again, Admiral. ','Don\'t underestimate the Force. ','Escape is not his plan. I must face him, alone. ','Escape is not his plan. I must face him. Alone. ','Give yourself to the Dark Side. It is the only way you can save your friends. Yes, your thoughts betray you. Your feelings for them are strong. Especially for... sister. So, you have a twin sister. Your feelings have now betrayed her, too. Obi-Wan was wise to hide her from me. Now his failure is complete. If you will not turn to the Dark Side... then perhaps she will... ','Good. You know it would be unfortunate if I had to leave a garrison here. ','He is as clumsy as he is stupid! General... prepare your troops for a surface attack. ','He is here. ','He will come to me? ','He will join us or die, my master. ','He will join us or die, my master. ','He will not be permanently damaged. ','He\'s all yours, bounty hunter. ','He\'s just a boy. Obi-Wan can no longer help him. ','His light saber. ','How is that possible? ','I am altering the deal. Pray I don\'t alter it any further. ','I do not want the Emperor\'s prize damaged. We will test it on Captain Solo. ','I find your lack of faith disturbing. ','I have *felt* him, my master. ','I have felt it. ','I have you now! ','I hope so, Commander, for your sake. The Emperor is not as forgiving as I am. ','I see you have constructed a new light saber. Your skills are complete. Indeed you are powerful as the Emperor has foreseen. ','I sense something; a presence I\'ve not felt since... ','I told you she would never consciously betray the Rebellion. ','I\'ve been waiting for you, Obi-Wan. We meet again, at last. The circle is now complete. When I left you, I was but the learner; now *I* am the master. ','If he could be turned, he will become a powerful ally. ','If he could be turned, he would be a powerful ally. ','If you only knew the power of the Dark Side. Obi-Wan never told you what happened to your father. ','Impressive. Most impressive. Obi-Wan has taught you well. You have controlled your fear. Now, release your anger. Only your hatred can destroy me. ','It is too late for me, son. The Emperor will show you the true nature of the Force. He is your master now. ','Luke, you can destroy the Emperor. He has foreseen this. It is your destiny. Join me, and together we can rule the galaxy as father and son. ','Luke, you do not yet realize your importance. You have only begun to discover your power. Join me, and I will complete your training. With our combined strength, we can end this destructive conflict and bring order to the galaxy. ','Luke... help me take this mask off. ','Make ready to land our troops beyond their energy field, and deploy the fleet, so that nothing gets off the system. ','Move the ship out of the asteroid field so that we can send a clear transmission. ','My son is with them. ','No. ','No. *I* am your father. ','No. Leave them to me. I will deal with them myself. ','NOOOOOOOOOO! ','Nothing... can stop that now. Just for once... let me... look on you with my *own* eyes. ','Obi-wan *is* here. The Force is with him. ','Obi-Wan has taught you well. ','Obi-Wan once thought as you do. You don\'t know the power of the Dark Side. I must obey my master. ','Perhaps I can find new ways to motivate them. ','Perhaps you think you\'re being treated unfairly? ','Search your feelings, you *know* it to be true! ','Several fighters have broken off from the main group. Come with me! ','So, you have accepted the truth? ','That is correct, Commander. And, he is most displeased with your apparent lack of progress. ','The Death Star will be completed on schedule. ','The Emperor has been expecting you. ','The Empire will compensate you, if he dies. Put him in. ','The Force is strong with this one. ','The force is with you, young Skywalker, but you are not a Jedi yet. ','The plans you refer to will soon be back in our hands. ','There is no conflict. ','There is no escape. Don\'t make me destroy you. ','There will be a substantial reward for the one who finds the Millenium Falcon. You are free to use any methods necessary but I want them alive - no disintegrations! ','There will be a substantial reward for the one who finds the Millennium Falcon. You are free to use any methods necessary, but I want them alive. No disintegrations. ','They are clear, my master. ','They must never again leave this city. ','They\'ve just made the jump into hyperspace. ','This will be a day long remembered. It has seen the end of Kenobi, it will soon see the end of the Rebellion. ','We would be honored if you would join us. ','We\'ll have to destroy them ship to ship. Get the crews to their fighters. ','Well, Calrissian, did he survive? ','What do you mean? ','What is it, General? ','What is thy bidding, my master? ','What is thy bidding, my master? ','What of the reports of the rebel fleet massing near Sullust? ','What? ','Yes, Admiral, what is it? ','Yes, Admiral? ','Yes, my Master. ','Yes, my master. ','You are in command now... Admiral Piett! ','You are part of the Rebel Alliance and a traitor! Take her away! ','You are unwise to lower your defenses! ','You cannot hide forever, Luke. ','You have failed me for the last time, Admiral! Captain Piett? ','You have learned much, young one. ','You may dispense with the pleasantries, Commander. I\'m here to put you back on schedule. ','You may take Captain Solo to Jabba the Hutt after I have Skywalker. ','You underestimate the power of the Dark Side. If you will not fight, then you will meet your destiny. ','Your destiny lies with me Skywalker. Obi-Wan knew this to be true. ','Your powers are weak, old man.','...Begin. ','...I think we\'d all be fascinated to hear what you have to say. ','Well I thought we\'d do a bit better then that! ','Come on, Harry! Let\'s see what school-boy spells you have up your sleeve! ','You have fought valiantly, but in vain. ','Nagini... dinner. ','Why do you live? ','Silence! Stupid girl. Harry Potter is dead, from this day forth... you put your faith in me. Harry Potter is dead! ','Welcome, Draco. ','My Lord? ','Avada Kedavra! ','You have to mean it, Harry. You know the spell. She killed him. She deserves it. ','I do not need your help. ','You\'ve lost, old man. ','Bring him to me. ','Only I can live forever. ','I have seen your heart and it\'s mine. I have seen your dreams, Ronald Weasley, and I have seen your fears... ','Least loved by the mother who craved a daughter. Least loved, by the girl who prefers your friend... ','As inspiring as I find your bloodlust Bellatrix, I must be the one to kill Harry Potter. ','Back when I had my body, I used to have mad game with the bitches. Just ask Bellatrix Lestrange. ','Behold, Nagini, our work is done. ','By which time I shall be gone, and you... shall be dead! ','Crucio! ','Even my Zefron poster? ','From this day forth, you put your faith... in me. ','Get me some Nasonex you swine! ','Ha! Spoken like a true politician. You will, I think, prove most useful, Pius. ','Harry Potter is dead! ','Harry Potter is dead! ','Harry Potter, the boy who lived... come to die. Avada Kedavra! ','How can you live with yourself, Lucius? ','I do not wish this. Every drop of magical blood spilled is a terrible waste. I therefore command my forces to retreat. ','I have seen your heart, and it is mine. ','I killed Snape! ','I need that prophecy. ','I\'ll kill him this time through and through! ','In their absence, dispose of your dead with dignity. Harry Potter, I now speak directly to you. On this night, you have allowed your friends to die for you rather than face me yourself. ','Join me in the forest tonight and confront your fate. ','My new world is about to unfold. ','No, I am extraordinary, but the wand... it resists me. ','Oh, I will. ','Okay, just relax with the dark king, okay? I watch you wipe your butt daily, you can call me Voldemort, we\'re there! We\'ve reached that point. ','Severus. I was beginning to worry that you had lost your way. Come, we\'ve saved you a seat. You bring news I trust? ','There is no greater dishonor. Join me in the Forbidden Forest and confront your fate. If you do not do this, I shall kill every last man, woman and child who tries to conceal you from me. ','They never learn. Such a pity. ','To those of you who do not know: we are joined tonight by Ms. Charity Burbage, who until recently taught at Hogwarts School Of Witchcraft And Wizardry. Her speciality was Muggle Studies. It is Ms. Burbage\'s belief that Muggles are not so different from us. She would, given her way, have us... mate with them. ','What say you, Pius? ','Where will he be taken, the boy? ','Wormtail! Have I not spoken to you about keeping our guest quiet? ','Ye-he-he. And now is the time to declare yourself. Come forward and join us... or die. ','You\'re a fool, Harry Potter, and you will lose everything.','... bitch.','...give me strength.','Ah the old college try, if you can\'t beat them... roast them.','Ah, don\'t worry about it. Maybe some weirdo can channel you!','AHH!','Ahh.','Ahhh. So you are afraid of something after all, huh?','Alice, come to daddy.','All I wanted you to do was kill a shit load of kids, but no, you\'d rather sit and stare at that stupid pumpkin! I was burned alive! Do you even know how that feels? It hurts like hell! What is your problem, anyway? They never took you trick-or-treating as a kid? You are really pissing me off, Myers.','Always room for more.','An apple a day won\'t keep ME away! Ha ha ha ha ha ha ha!','And now you\'re all alone! Kristen, why don\'t you - uh - call on one of your little friends? Maybe they could help.','And now, she\'s gonna take me to a whole new playground.','And them? Why are they here?','ANSWER ME!','Ash Williams.','Awww... how sweet.','Bad year, Dan!','Bed.','Big deal!','Bon appetit, bitch!','Bon appÈtit...','But I just keep on tickin\'... because they promised me that.','But this... this is my favorite.','But your body says yes...','Call me crazy, but it looks to me like you\'re the murderer, babe!','Come to Freddy.','Daddy can\'t help you now!','Daddy\'s waiting for you, little girl.','Did you know that after the heart stops beating, the brain can function for well over seven minutes?','DIE.','Do you think you can bring the dead back to life?','Don\'t ruin my good looks, asshole!','Don\'t worry here at Corpus rigor mortis we\'re always looking for new members.','Don\'t worry I\'ll be real gentle','Don\'t worry, you had quite a nasty bump.','Dream a little dream... of ME!','Drugs. Now there\'s a REAL nightmare!','Elm Street\'s last brat. Farewell.','Every town has an Elm Street!','Father knows best.','Feeling better now?','Filet de Barbie!','Find the book, Lucy. Bring back the ash.','For now, maybe... but when you wake up... It\'s back... in the saddle... again.','Freddy!','Fuel injection!','Go ahead, Jesse. Try it on for size.','Go ahead... put it on. It\'s in your blood. That\'s it. Put it on. Feels good, doesn\'t it? Yeah... come on. Let your daddy show you how to use it.','Goddamn rednecks!','Gone... but not forgotten.','Got your nose!','Grounded!','Ha ha! Ya fuckin\' nerd. Ya wanna play some "Dr. Jekyll and Mr. Hyde"?','Have it MY WAY','He can\'t fight me. I\'m him.','He can\'t hear you, because I\'m him.','Help yourself, fucker!','Hey Merit, ever had a man in your bed before?','Hey Spencer, let\'s trip out.','Hey! You forgot the power glove.','Hey, asshole! Up here!','Hey, Danny, better not dream and drive.','Hey, Nancy.','Hi, Kris.','Hi... This baby comes with my guarantee. One mile or the driver\'s life, whichever comes first.','Hmm!','Hmm. Great graphics.','Hmmm.','Hmmm... great graphics.','How sweet, dark meat.','How sweet, fresh meat.','How sweet. Fresh meat.','How\'s this for a wet dream?','How\'s this for a wet dream?','I beat my high score... Hahahahahahaha!','I believe in you.','I didn\'t fucking think so!','I didn\'t need a glove to kill your bitch of a mother, and I don\'t need one now!','I don\'t get it. They should be here by now.','I don\'t know, Jesse!','I haven\'t even cut you yet!','I know. Isn\'t it great?','I love screamers.','I need you to send a little message for me. That\'s all, just a little message.','I need you, Jesse. We got special work to do here, you and me.','I said, "Where\'s the fucking bourbon?"','I think I\'ll stick to teenagers.','I think the honeymoon is over.','I thought I was up to... Yvonne!','I wanna draw some blood!','I wanna draw some blood!','I want it all!','I was just petting him.','I\'d rather burn up than fade away.','I\'ll get you, my pretty! And your little soul, too!','I\'ll have to pass that message myself. Won\'t I, hmm?','I\'ll kill you slow!','I\'m dying to see what skeletons are hidden in your closet.','I\'m going to split you in two.','I\'m here.','I\'m not. Ha ha ha!','I\'m your boyfriend now, Nancy.','I\'m your boyfriend now, Nancy.','I\'m your boyfriend now.','I\'m your friend, Jacob. Just like a daddy. Heh, huh. Gootchy-gootchy-goo! Gootchy, gootchy, goo! I gotcha! I gotcha! I gotcha. I gotcha.','I\'ve always had a thing for the whores that live in this house.','I\'ve been away from my children for far too long.','I\'ve got the brain.','I... am... eternal.','If Ghostface got voted out, take it from Freddy, that would be a dream come true! HAHAHAHA! You get it? HAHAHAHA! A Dream? HAHAHAHA! I kill people in their nightmares, man. That\'s what I do, it\'s my thing!','If I were you, lady, I\'d kill the ungrateful piggy.','If the food don\'t kill ya, the service will.','If you can keep a secret, I\'ll take you to a special place.','If you thought that romance was dead... now you know who to blame. She loves me, she loves me not, she loves me, she loves me HOT!','If you\'re thinking of leaving Springwood... You ain\'t going nowhere.','It\'s a boy!','It\'s not my fault this bitch is dead on her feet.','It\'s ok! I had Subway for lunch!','It\'s real. I\'m real.','It\'s the chair for you, kid.','It\'s time for our boy faced the music with Rapmaster Freddy.','It\'s travelin\' time!','Joey... look. All the little PIGGIES come home.','Kids... always a disappointment.','Kill for me.','Kung fu THIS, bitch.','Let\'s get high.','Little Nancy. All grown up.','Little Nancy. Now that you caught me, what game do you wanna play next?','Madam, if I may.','Man the torpedoes.','Merit... Merit... over here... room for one more.','Might be your dream, but it\'s my RULES!','Mmm... Rick, you little meatball. I love soul food. Bring me more.','Mmm... the usual. My favorite. Mmm... Eeney, meeney, miney... MOE!','Mr. Anderson, welcome back.','My children... from the very beginning, it was the children who gave me my power. The Springwood Slasher, that\'s what they called me. My reign of terror was legendary. Dozens of children would fall by my blades. Then the parents of Springwood came for me, taking justice into their own hands. When I was alive, I might have been a little naughty, but after they killed me, I became something much, much worse. The stuff nightmares are made of. The children still feared me, and their fear gave me the power to invade their dreams, and that\'s when the fun REALLY began. Until they figured out a way to forget about me. To erase me completely. Being dead wasn\'t a problem, but being forgotten, now that\'s a BITCH. I can\'t come back if nobody remembers me. I can\'t come back if nobody\'s afraid. I had to search the bowels of Hell, but I found someone, someone who\'ll make \'em remember. He may get the blood, but I\'ll get the glory, and that fear is my ticket home.','Nice try, Alice. Thanks, babe. It\'s my new look. Like it?','Nice try, Nancy. Now let me take a stab.','No balls, huh, Voorhees?','No pain, no gain.','No screaming while the bus is in motion.','No! She\'s Mine! Mine! *Mine!*','No, no! It\'s not supposed to be like this!','No, you can\'t! My powers...!','No. Just me...','No?','No?','Not a chance, I\'m havin\' too much fun!','Not my arm!','Not strong enough, yet. Well, I will be soon enough. Until then... I\'ll let Jason have some fun.','Now be a good little doggy and go fetch!','Now I\'m playing with power!','Now it\'s time to put this bad dog to sleep... for good!','Now why don\'t you just fucking *die*?','Now you die.','Oh great, the mama\'s boy!','Oh, Carlos. Lend me your ear.','Oh, don\'t worry about my little errand boy. The only thing to fear, is fear himself!','Oh, that\'s music to my ears.','Oh, that\'s right! Everyone forgot! That\'s why they weren\'t afraid anymore! That\'s why I needed Jason to kill for me to get them to remember. But now he just won\'t stop...','Oh, you better speak up. Must be my deaf ear.','Oh.','Oh... Kids.','Ohh. Do you think *I\'m* your daddy? Mm-mm! Wrong!','Ohhh sister sister... sister\'s keeper.','One down, two to go.','One down. Two to go.','only a mother could love.','Only long enough for to bring me back my daughter.','Ooh, sounds like fun. It\'s a little fast for me. How about we hang, first?','Oops. No pain, no gain!','Open wide!','Or do ya wanna play my game, bitch?','Penny for your thoughts, chief!','Remember me?','Run, Neil, run!','Second helping!','Shut up, bitch! He can\'t hear you.','So, you want to make her scream?','Sorry, kid. I don\'t believe in fairy tales.','Sorry. Is Nancy there, please?','Stick *that* in your VCR... and suck on it!','Sticks and stones may break my bones, but nothing will ever kill me. Well, let\'s see now. First, they tried burning me.','Tag. You\'re it.','Taryn. Taryn.','Tell \'em Freddy sent ya.','Tell Freddy where it doesn\'t hurt!','That hockey puck!','That was then, this is now.','That\'s right. No one can ever prove I was ever here.','The dream people. The ones that gave me this job. In dreams... I am forever! Too bad you\'re not.','The ties that bind... The chains of love... Unbreakable, Indestructible and tasty too.','Then they tried burying me.','There is no Jesse! I\'m Jesse now!','There you go.','There\'s only one cure for me, buddy boy. You gotta die!','These are my children, Jason. Go back to where you belong.','They even tried holy water!','They should have drowned you at birth!','Think you\'re so smart! Huh, bitch?','This is it, Jennifer: your big break in TV.','This should do it.','This show\'s about to be canceled, too much dead air. Next call.','This shrink really ought to have her head examined.','This time I\'ll do the cooking!','This... is God!','Tilt!','Time to start all over again.','Tina.','Tina...','Told you comic books was bad for ya!','Trick or treat! How\'s that for a face lift?','Uh oh.','Uhh! Oh, scary.','Wake up! You\'re bleeding.','Wake up, little girl.','Wanna suck face?','We got six more minutes to play.','We\'ll see, bitch. We\'ll just see.','Welcome home, Taryn. Look familiar?','Welcome to my nightmare.','Welcome to my world, bitch.','Welcome to my world, bitch. I should warn you, princess... the first time tends to get a little... messy.','Welcome to prime time, bitch!','Welcome to Wonderland, Alice.','Well I ain\'t Dr. Seuss.','Well, I found the key!','What a rush!','What do you think I did? I didn\'t do anything!','What\'s going on? What have you done to me?','What\'s with kids today, huh? No respect.','What\'s wrong, Joey? Feeling tongue-tied?','What\'s wrong, Lori? Miss your wake-up call?','Where are you going, piglet? The party\'s just starting.','Who gives a fuck what you think?','Who ya gonna kill? Ghostbusters! Ha ha ha ha ha ha!','Whoa, look at me. I\'m a fucking nerd. What a piece of shit. Buffalo diarrhea fuck farts.','Why are you screaming?','Why don\'t you... reach out... and cut someone?','Why sure, Ollie.','Why won\'t you DIE?','Why, uh, why should we fight? We\'re old friends, you and I. Remember?','Will, you look tired. Have a seat.','Ya like "Nintendo"?','Ya like to play shitty games?','Yeah! Play that shitty game!','Yeah! What are you on? Looks like a frying pan and some eggs to me.','Yee-haw! This boy feels the need for speed.','Yes, you did. In your dream.','Yes. The souls of the children...','You are all my children now.','You are, what you eat!','You can check in, but you can\'t check out.','You can\'t hurt me. This is my world. And you can\'t ever leave.','You can\'t save her.','You can\'t wake up. I had to keep you awake long enough so when you finally slept, you\'d never wake up again. We\'re gonna be in here a long time. Did you really think your boyfriend could wake you up?','You don\'t remember? You must. You\'re my number one. You\'re my... little Nancy.','You forgot where you came from, kid... but I know where you\'re going.','You have nothing to worry about. This wont hurt one... little... bit.','You look just as beautiful as ever.','You really shouldn\'t fall asleep in class.','You see, Nerd, nobody makes you play these games but yourself. So you\'re your own damn nightmare. Now, you\'re gonna die.','You should always respect your elders.','You should listen to your mother.','You shouldn\'t have buried me. I\'m not dead.','You smell different.','You think that I\'m afraid of you? Huh? Now that we\'re in the real world? Come on!','You think you can turn back time?','You think you was gonna get away from me?','You think you\'ve got what it takes? I\'ve been guarding my gate for a long time, bitch.','You ugly little shit. Now there\'s a face...','You what?','You!','You\'re gettin\' warm.','You\'re mine now, piggy.','You\'re my blood. Only you could\'ve brought me out - in your mind.','You\'re on the wrong side of the tracks... Neil!','You\'re slow, you\'re stupid, and you got no style.','You\'ve got the body...','You\'ve got their powers. I\'ve got their souls. Come on!','Your eyes say "no, no." But my mouth says "yes, yes."','Your girlfriend\'s here. Be right back.','Your mouth says no...','Your shift is over.','Your wish... is my command.'];

  slack.on('open', function() {
    var channel, channels, group, groups, id, messages, unreads;
    channels = [];
    groups = [];
    unreads = slack.getUnreadCount();
    channels = (function() {
      var ref, results;
      ref = slack.channels;
      results = [];
      for (id in ref) {
        channel = ref[id];
        if (channel.is_member) {
          results.push("#" + channel.name);
        }
      }
      return results;
    })();
    groups = (function() {
      var ref, results;
      ref = slack.groups;
      results = [];
      for (id in ref) {
        group = ref[id];
        if (group.is_open && !group.is_archived) {
          results.push(group.name);
        }
      }
      return results;
    })();
    console.log("Welcome to Slack. You are @" + slack.self.name + " of " + slack.team.name);
    console.log('You are in: ' + channels.join(', '));
    console.log('As well as: ' + groups.join(', '));
    messages = unreads === 1 ? 'message' : 'messages';
    return console.log("You have " + unreads + " unread " + messages);
  });

  slack.on('message', function(message) {
    var channel, channelError, channelName, errors, response, text, textError, ts, type, typeError, user, userName, firstWord;
    channel = slack.getChannelGroupOrDMByID(message.channel);
    user = slack.getUserByID(message.user);
    response = '';
    type = message.type, ts = message.ts, text = message.text;
    channelName = (channel != null ? channel.is_channel : void 0) ? '#' : '';
    channelName = channelName + (channel ? channel.name : 'UNKNOWN_CHANNEL');
    userName = (user != null ? user.name : void 0) != null ? "@" + user.name : "UNKNOWN_USER";
    console.log("Received: " + type + " " + channelName + " " + userName + " " + ts + " \"" + text + "\"");
    
    // get first word to see if user is addressing eviltoph
    firstWord = text.split(' ')[0];
    var greetings = [slack.self.name,"@"+slack.self.name,"@"+slack.self.name+":"];
    var areYouAddressingMe = (greetings.indexOf(firstWord) !== -1);
    if (type === 'message' && (text != null) && (channel != null) && areYouAddressingMe) {

      // remove eviltoph name from text
      text = text.replace(firstWord+" ","");

      var evilMatches = [];
      // evil sentences
      evil.forEach(function(evilSentence,i){
        // seed this sentence
        m.seed(evilSentence);
        // see how well input message matches this sentence (not currently in use for response)
        evilMatches.push({index: i, score: natural.JaroWinklerDistance(text,evilSentence)});
      });

      var tophMatches = [];
      // toph sentences
      toph.forEach(function(tophSentence,i){
        // seed this sentence
        m.seed(tophSentence);
        // see how well input message matches this sentence (not currently in use for response)
        tophMatches.push({index: i, score: natural.JaroWinklerDistance(text,tophSentence)});
      });

      // Search for a starting key in input message, then generate a markov chain in both directions starting at key. 
      // Return an array of the raw word forms along the way including the raw word form of the supplied key.
      // Stop when the traversal hits a terminal entry or when limit words have been generated if limit is specified.
      // ^ explanation from https://github.com/substack/node-markov
      var res = m.respond(text).join(' ');

      // add fire emojis and send response
      response = ":fire: "+res.toUpperCase()+" :fire:";
      channel.send(response);

      // get setence that best matches input message 
      // not currently in use for response, but logs result
      evilMatches.sort(function(a,b){ return b.score - a.score });
      tophMatches.sort(function(a,b){ return b.score - a.score });
      var evilSentence = evil[evilMatches[0].index];
      var tophSentence = toph[tophMatches[0].index];
      console.log(evilSentence+tophSentence);
      
      return console.log("@" + slack.self.name + " responded with \"" + response + "\"");
    } else {
      typeError = type !== 'message' ? "unexpected type " + type + "." : null;
      textError = text == null ? 'text was undefined.' : null;
      channelError = channel == null ? 'channel was undefined.' : null;
      errors = [typeError, textError, channelError].filter(function(element) {
        return element !== null;
      }).join(' ');
      return console.log("@" + slack.self.name + " could not respond. " + errors);
    }
  });

  slack.on('error', function(error) {
    return console.error("Error: " + error);
  });

  slack.login();

}).call(this);
